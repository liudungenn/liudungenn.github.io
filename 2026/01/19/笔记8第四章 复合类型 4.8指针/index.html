

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="刘钝根">
  <meta name="keywords" content="">
  
    <meta name="description" content="指针  4.8 指针、数组和指针算数">
<meta property="og:type" content="article">
<meta property="og:title" content="第四章 复合类型 指针4.8">
<meta property="og:url" content="https://liudungenn.github.io/2026/01/19/%E7%AC%94%E8%AE%B08%E7%AC%AC%E5%9B%9B%E7%AB%A0%20%E5%A4%8D%E5%90%88%E7%B1%BB%E5%9E%8B%204.8%E6%8C%87%E9%92%88/index.html">
<meta property="og:site_name" content="刘钝根">
<meta property="og:description" content="指针  4.8 指针、数组和指针算数">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2026-01-19T17:00:00.000Z">
<meta property="article:modified_time" content="2026-01-20T08:43:51.874Z">
<meta property="article:author" content="刘钝根">
<meta property="article:tag" content="C++笔记">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>第四章 复合类型 指针4.8 ❤️ 刘钝根</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"liudungenn.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"❤️","loop":"flase","scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>刘钝根的博客</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="第四章 复合类型 指针4.8"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2026-01-19 17:00" pubdate>
          2026年1月19日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          1.3k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          12 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>

    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">第四章 复合类型 指针4.8</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="C-primer-plus-笔记"><a href="#C-primer-plus-笔记" class="headerlink" title="C++ primer plus 笔记"></a>C++ primer plus 笔记</h1><h2 id="第四章-复合类型-指针相关"><a href="#第四章-复合类型-指针相关" class="headerlink" title="第四章 复合类型-指针相关"></a>第四章 复合类型-指针相关</h2><h3 id="4-8-指针、数组和指针算数"><a href="#4-8-指针、数组和指针算数" class="headerlink" title="4.8 指针、数组和指针算数"></a>4.8 指针、数组和指针算数</h3><h4 id="4-8-1-程序说明"><a href="#4-8-1-程序说明" class="headerlink" title="4.8.1　 程序说明"></a>4.8.1　 程序说明</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br>	<span class="hljs-type">double</span> wages[<span class="hljs-number">3</span>] = &#123; <span class="hljs-number">1000.0</span>,<span class="hljs-number">2000.0</span>,<span class="hljs-number">3000.0</span> &#125;;<br>	<span class="hljs-type">short</span> stacks[<span class="hljs-number">3</span>] = &#123; <span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span> &#125;;<br>	<span class="hljs-type">double</span>* pw = wages;<br>	cout &lt;&lt; <span class="hljs-string">&quot;pw=&quot;</span> &lt;&lt; pw &lt;&lt; <span class="hljs-string">&quot; *pw=&quot;</span> &lt;&lt; *pw &lt;&lt; endl;<br>	cout &lt;&lt; <span class="hljs-string">&quot;&amp;wages=&quot;</span> &lt;&lt; &amp;wages &lt;&lt; <span class="hljs-string">&quot;,wages[0]=&quot;</span> &lt;&lt;wages[<span class="hljs-number">0</span>]&lt;&lt; <span class="hljs-string">&quot;, *wages=&quot;</span> &lt;&lt; wages &lt;&lt; endl;<br>	pw = pw + <span class="hljs-number">1</span>;<br>	cout &lt;&lt; <span class="hljs-string">&quot;pw=&quot;</span> &lt;&lt; pw &lt;&lt; <span class="hljs-string">&quot;, *pw=&quot;</span> &lt;&lt; *pw &lt;&lt; endl;<br>	<span class="hljs-type">short</span>* ps = &amp;stacks[<span class="hljs-number">0</span>];<br>	cout &lt;&lt; <span class="hljs-string">&quot;ps=&quot;</span> &lt;&lt; ps &lt;&lt; <span class="hljs-string">&quot;, *ps=&quot;</span> &lt;&lt; *ps &lt;&lt; endl;<br>	ps = ps + <span class="hljs-number">1</span>;<br>	cout &lt;&lt; <span class="hljs-string">&quot;ps=&quot;</span> &lt;&lt; ps &lt;&lt; <span class="hljs-string">&quot;, *ps=&quot;</span> &lt;&lt; *ps &lt;&lt; endl;<br>    cout&lt;&lt;<span class="hljs-string">&quot;stacks is &quot;</span>&lt;&lt;<span class="hljs-built_in">sizeof</span>(stacks) &lt;&lt; <span class="hljs-string">&quot;pw is &quot;</span> &lt;&lt;<span class="hljs-keyword">sizeof</span> pw &lt;&lt; <span class="hljs-string">&quot; wages is &quot;</span>&lt;&lt;<span class="hljs-keyword">sizeof</span> wages &lt;&lt;endl;<br><br>	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">pw</span>=000000224075F9F8 *<span class="hljs-attribute">pw</span>=1000<br>&amp;wages[0]=000000224075F9F8,wages[0]=000000224075F9F8, *<span class="hljs-attribute">wages</span>=000000224075F9F8<br><span class="hljs-attribute">pw</span>=000000224075FA00, *<span class="hljs-attribute">pw</span>=2000<br><span class="hljs-attribute">ps</span>=000000224075FA24, *<span class="hljs-attribute">ps</span>=3<br><span class="hljs-attribute">ps</span>=000000224075FA26, *<span class="hljs-attribute">ps</span>=2<br>stacks is 6 pw is 8 wages is 24<br></code></pre></td></tr></table></figure>
<p>数组名做指针stackes[1] &#x3D; *(stacks+1),仅为元素地址偏移。<br>arrayname[i] becomes *(arrayname + i)数组<br>pointname[i] becomes *(pointname + i)指针<br>所以指针可以使用数组名。</p>
<p>wages和&amp;wages都是数组的地址，为第一个元素，wages[0]取得是第一个值的地址，虽然相同，但意思不同。&amp;wages是数组，可以将数组赋给指针.<br>double （<em>pa） [10] &#x3D; &wages;<br>这是个数组指针，</em>pa和wages是等价的，（ *p ）[0]的值就是wages数组的第一个值。</p>
<h4 id="4-8-3-指针和字符串"><a href="#4-8-3-指针和字符串" class="headerlink" title="4.8.3　 指针和字符串"></a>4.8.3　 指针和字符串</h4><p>在cout和多数C++表达式中,char数组名\char指针以及用引号括起来的字符串常量都被解释为字符串第一个字符的地址.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">pragma</span> <span class="hljs-keyword">warning</span>(disable:4996)</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br>	<span class="hljs-type">char</span> animal[<span class="hljs-number">20</span>] = <span class="hljs-string">&quot;bear&quot;</span>;<br>	<span class="hljs-type">const</span> <span class="hljs-type">char</span> * bird =<span class="hljs-string">&quot;wren&quot;</span>;<span class="hljs-comment">//不加const系统默认有可能对字符串常量进行修改</span><br>	<span class="hljs-type">char</span> * ps;<span class="hljs-comment">//只声明该指针不初始化</span><br>	cout &lt;&lt; animal&lt;&lt;<span class="hljs-string">&quot; and &quot;</span> &lt;&lt; bird &lt;&lt; endl;<br>	cout&lt;&lt; <span class="hljs-string">&quot;enter a kind of animal:&quot;</span>&lt;&lt;endl;<br>	cin&gt;&gt;animal;<br>	ps = animal;<br>	cout &lt;&lt; ps&lt;&lt;endl;<br>	cout &lt;&lt;<span class="hljs-string">&quot;before using strcpy():\n&quot;</span>;<br>	cout &lt;&lt; animal&lt;&lt;<span class="hljs-string">&quot; at &quot;</span>&lt;&lt;(<span class="hljs-type">int</span> *)animal&lt;&lt;endl;<br>	cout &lt;&lt; ps &lt;&lt; <span class="hljs-string">&quot; at &quot;</span> &lt;&lt; (<span class="hljs-type">int</span>*)ps &lt;&lt; endl;<span class="hljs-comment">//强制转换可以看到ps的地址</span><br>	ps = <span class="hljs-keyword">new</span> <span class="hljs-type">char</span> [<span class="hljs-built_in">strlen</span>(animal)<span class="hljs-number">+1</span>];<span class="hljs-comment">//获取animal的字符串长度加上\0</span><br>	<span class="hljs-built_in">strcpy</span>(ps,animal);<br>	cout &lt;&lt; <span class="hljs-string">&quot;after using strcpy():\n&quot;</span>;<br>	cout &lt;&lt; animal &lt;&lt; <span class="hljs-string">&quot; at &quot;</span> &lt;&lt; (<span class="hljs-type">int</span>*)animal &lt;&lt; endl;<br>	cout &lt;&lt; ps &lt;&lt; <span class="hljs-string">&quot; at &quot;</span> &lt;&lt; (<span class="hljs-type">int</span>*)ps &lt;&lt; endl;<br>	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs text">bear and wren<br>enter a kind of animal:<br>fox<br>fox<br>before using strcpy():<br>fox at 00000045E87BF718<br>fox at 00000045E87BF718<br>after using strcpy():<br>fox at 00000045E87BF718<br>fox at 000001AD071C5570<br></code></pre></td></tr></table></figure>
<p>上面我们用strlen获取字符串长度,再加上”\0”的长度,用new运算符开辟一个空间将这个内存空间分配给ps,同时用strcpy拷贝animal的字符给ps,这样就将animal储存在了ps的内存空间.其中我们无法像别的数据类型一样直接获取字符串的地址,因为它将会读取字符而不是地址,程序中我们用强制转换将char类型转换成整型,取出储存地址.<br>const char * bird &#x3D;”wren”;我们用const是为了用bird直接访问字符串,但是不能修改.</p>
<h4 id="4-8-4-使用new来创建动态结构"><a href="#4-8-4-使用new来创建动态结构" class="headerlink" title="4.8.4　 使用new来创建动态结构"></a>4.8.4　 使用new来创建动态结构</h4><p>在运行时创建数组优于在编译时创建数组,对于结构也是如此.我们可以用new来创建动态结构,也就是在运行时而不是在编译时,将new用于结构有两步可以完成,创建结构和访问其成员.<br>要创建一个未命名的inflatable类型并将其赋给一个指针可以这样:<br>inflatable * pa &#x3D; new inflatable;<br>运算符是-&gt;上面我们可以表示为ps-&gt;price,还有一种方法,*ps就是所指向的值–结构本身.由于 *ps是一个结构,因此( *ps).price也是一种表示方法.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">inflatable</span><br>&#123;<br><span class="hljs-type">char</span> name[<span class="hljs-number">20</span>];<br><span class="hljs-type">float</span> volume;<br><span class="hljs-type">double</span> price;<br>&#125;;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br>	inflatable * ps = <span class="hljs-keyword">new</span> inflatable;<br>	cout &lt;&lt; <span class="hljs-string">&quot;enter name of inflatable itme:&quot;</span>;<br>	cin.<span class="hljs-built_in">get</span>(ps-&gt;name,<span class="hljs-number">20</span>);<br>	cout &lt;&lt; <span class="hljs-string">&quot;enter volume of inflatable itme:&quot;</span>;<br>	cin&gt;&gt;(*ps).volume;<br>	cout &lt;&lt; <span class="hljs-string">&quot;enter price of inflatable itme:&quot;</span>;<br>	cin&gt;&gt;ps-&gt;price;<br>	cout&lt;&lt;<span class="hljs-string">&quot;name :&quot;</span>&lt;&lt;ps-&gt;name&lt;&lt;endl;<br>	cout &lt;&lt; <span class="hljs-string">&quot;volume :&quot;</span> &lt;&lt; (*ps).volume &lt;&lt; endl;<br>	cout &lt;&lt; <span class="hljs-string">&quot;price$ :&quot;</span> &lt;&lt; ps-&gt;price &lt;&lt; endl;<br>	<span class="hljs-keyword">delete</span> ps;<br>	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs text">enter name of inflatable itme:cui yuhui<br>enter volume of inflatable itme:12.21<br>enter price of inflatable itme:26.14<br>name :cui yuhui<br>volume :12.21<br>price$ :26.14<br></code></pre></td></tr></table></figure>
<h2 id="上面演示的是创建一个未命名的结构-并用两种方法访问它-下面是使用new和delete的示例-程序说明-上面程序我们用了getname-还用了strlen来获取临时变量收到的字符串长度加上”-0”后用new开辟一个对应的内存空间-再将临时变量的字符复制粘贴到pn-函数返回pn-这是字符串副本的地址-main-中-返回值-地址-被赋给指针name-该指针是在main-中定义的-但它指向getname-函数中分配的内存块-然后程序就打印该字符串及地址-上面程序我们是在getname-中new了新的内存-在main-中detele的-分开放置是可以的-4-8-5-自动存储-静态存储和动态存储"><a href="#上面演示的是创建一个未命名的结构-并用两种方法访问它-下面是使用new和delete的示例-程序说明-上面程序我们用了getname-还用了strlen来获取临时变量收到的字符串长度加上”-0”后用new开辟一个对应的内存空间-再将临时变量的字符复制粘贴到pn-函数返回pn-这是字符串副本的地址-main-中-返回值-地址-被赋给指针name-该指针是在main-中定义的-但它指向getname-函数中分配的内存块-然后程序就打印该字符串及地址-上面程序我们是在getname-中new了新的内存-在main-中detele的-分开放置是可以的-4-8-5-自动存储-静态存储和动态存储" class="headerlink" title="上面演示的是创建一个未命名的结构,并用两种方法访问它.下面是使用new和delete的示例:程序说明:上面程序我们用了getname(),还用了strlen来获取临时变量收到的字符串长度加上”\0”后用new开辟一个对应的内存空间,再将临时变量的字符复制粘贴到pn,函数返回pn,这是字符串副本的地址.main()中,返回值(地址)被赋给指针name,该指针是在main()中定义的,但它指向getname()函数中分配的内存块.然后程序就打印该字符串及地址.上面程序我们是在getname()中new了新的内存,在main()中detele的,分开放置是可以的.#### 4.8.5　 自动存储\静态存储和动态存储"></a>上面演示的是创建一个未命名的结构,并用两种方法访问它.<br>下面是使用new和delete的示例:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">pragma</span> <span class="hljs-keyword">warning</span>(disable:4996)</span><br><span class="hljs-function"><span class="hljs-type">char</span> * <span class="hljs-title">getname</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span></span>;<br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-type">char</span> * name ;<br>	name = <span class="hljs-built_in">getname</span>();<br>	cout&lt;&lt;name&lt;&lt;<span class="hljs-string">&quot; at &quot;</span>&lt;&lt;(<span class="hljs-type">int</span>*)name&lt;&lt;endl;<br>	<span class="hljs-keyword">delete</span> []name;<br>	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">char</span> * <span class="hljs-title">getname</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-type">char</span> temp[<span class="hljs-number">80</span>];<br>	cout&lt;&lt;<span class="hljs-string">&quot;enter ur name :&quot;</span>;<br>	cin&gt;&gt;temp;<br>	<span class="hljs-type">char</span> * pn = <span class="hljs-keyword">new</span> <span class="hljs-type">char</span>[<span class="hljs-built_in">strlen</span>(temp) <span class="hljs-number">+1</span>];<br>	<span class="hljs-built_in">strcpy</span>(pn,temp);<br>	<span class="hljs-keyword">return</span> pn;<br>&#125;<br></code></pre></td></tr></table></figure><br><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs text">enter ur name :fredeldumpkin<br>fredeldumpkin at 00000188085C1BC0<br></code></pre></td></tr></table></figure><br>程序说明:<br>上面程序我们用了getname(),还用了strlen来获取临时变量收到的字符串长度加上”\0”后用new开辟一个对应的内存空间,再将临时变量的字符复制粘贴到pn,函数返回pn,这是字符串副本的地址.main()中,返回值(地址)被赋给指针name,该指针是在main()中定义的,但它指向getname()函数中分配的内存块.然后程序就打印该字符串及地址.<br>上面程序我们是在getname()中new了新的内存,在main()中detele的,分开放置是可以的.<br>#### 4.8.5　 自动存储\静态存储和动态存储</h2>
                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/C-%E7%AC%94%E8%AE%B0/" class="category-chain-item">C++笔记</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/C-%E7%AC%94%E8%AE%B0/" class="print-no-link">#C++笔记</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>第四章 复合类型 指针4.8</div>
      <div>https://liudungenn.github.io/2026/01/19/笔记8第四章 复合类型 4.8指针/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>刘钝根</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2026年1月19日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2026/01/20/%E7%AC%94%E8%AE%B09%E7%AC%AC%E5%9B%9B%E7%AB%A0%20%E5%A4%8D%E5%90%88%E7%B1%BB%E5%9E%8B%204.9%E7%B1%BB%E5%9E%8B%E7%BB%84%E5%90%88/" title="第四章 复合类型">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">第四章 复合类型</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2026/01/14/%E7%AC%94%E8%AE%B07%E7%AC%AC%E5%9B%9B%E7%AB%A0%20%E5%A4%8D%E5%90%88%E7%B1%BB%E5%9E%8B%204.7%E6%8C%87%E9%92%88/" title="第四章 复合类型 指针">
                        <span class="hidden-mobile">第四章 复合类型 指针</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>




  
<script src="/js/fireworks.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>

<!-- 1. 全局鼠标烟花特效 -->
<canvas id="fireworks" style="position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;pointer-events:none;background:transparent;"></canvas>
<script>
const c = document.getElementById("fireworks");
const ctx = c.getContext("2d");
function resizeCanvas() {
  c.width = window.innerWidth;
  c.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

class Particle {
  constructor(x, y) {
    this.x = x;
    this.y = y;
    this.size = Math.random() * 2 + 1;
    this.vx = (Math.random() - 0.5) * 5;
    this.vy = (Math.random() - 0.5) * 5;
    // 适配深色/浅色模式
    const isDark = document.documentElement.dataset.defaultColorScheme === 'dark';
    this.color = isDark 
      ? `rgb(${Math.random()*255|0},${Math.random()*255|0},${Math.random()*255|0})`
      : `rgb(${Math.random()*100+155|0},${Math.random()*100+155|0},${Math.random()*100+155|0})`;
    this.life = 30;
  }
  update() {
    this.x += this.vx;
    this.y += this.vy;
    this.size *= 0.95;
    this.life--;
  }
  draw() {
    ctx.fillStyle = this.color;
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
    ctx.fill();
  }
}

let particles = [];
document.addEventListener('mousemove', (e) => {
  for (let i = 0; i < 2; i++) {
    particles.push(new Particle(e.clientX, e.clientY));
  }
});

function animateFireworks() {
  ctx.fillStyle = "rgba(0,0,0,0.05)";
  ctx.fillRect(0, 0, c.width, c.height);
  for (let i = particles.length - 1; i >= 0; i--) {
    particles[i].update();
    particles[i].draw();
    if (particles[i].life <= 0) {
      particles.splice(i, 1);
    }
  }
  requestAnimationFrame(animateFireworks);
}
animateFireworks();
</script>

<!-- 2. Banner背景（图片/视频）+ Hover烟花 -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  const useVideoBanner = false; // 默认为图片模式（稳定），需要视频时改为true
  const banner = document.getElementById('banner');
  if (!banner) return;
  
  if (useVideoBanner) {
    banner.style.background = 'none';
    const video = document.createElement('video');
    video.src = '/video/banner-video.mp4'; // 视频路径：根目录/video文件夹下
    video.autoplay = true;
    video.loop = true;
    video.muted = true;
    video.playbackRate = 0.8;
    video.style.cssText = `
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: -1;
    `;
    banner.appendChild(video);
    // 视频加载失败自动降级为图片
    video.addEventListener('error', () => {
      setImageBanner();
    });
  } else {
    setImageBanner();
  }

  // 图片背景配置（默认生效）
  function setImageBanner() {
    banner.style.background = 'url(/img/default.png) no-repeat center center';
    banner.style.backgroundSize = 'cover';
  }

  // Banner Hover烟花特效
  const canvas = document.createElement('canvas');
  canvas.id = 'banner-fireworks';
  canvas.style.cssText = "position:absolute;top:0;left:0;width:100%;height:100%;z-index:1;pointer-events:none;background:transparent;";
  banner.appendChild(canvas);
  
  function resizeBannerCanvas() {
    const rect = banner.getBoundingClientRect();
    canvas.width = rect.width;
    canvas.height = rect.height;
    canvas.style.top = `${rect.top}px`;
    canvas.style.left = `${rect.left}px`;
  }
  resizeBannerCanvas();
  window.addEventListener('resize', resizeBannerCanvas);
  
  const ctx2 = canvas.getContext("2d");
  let bannerParticles = [];
  let isHoverBanner = false;
  let hoverX = 0, hoverY = 0;
  
  banner.addEventListener('mouseenter', () => isHoverBanner = true);
  banner.addEventListener('mouseleave', () => isHoverBanner = false);
  banner.addEventListener('mousemove', (e) => {
    const rect = banner.getBoundingClientRect();
    hoverX = e.clientX - rect.left;
    hoverY = e.clientY - rect.top;
  });
  
  function createBannerParticle() {
    if (!isHoverBanner) return;
    const centerX = hoverX;
    const centerY = hoverY;
    for (let i = 0; i < 6; i++) {
      const angle = (i / 8) * Math.PI * 2;
      const distance = Math.random() * 15 + 5;
      // 适配深色/浅色模式
      const isDark = document.documentElement.dataset.defaultColorScheme === 'dark';
      const color = isDark 
        ? `rgb(${Math.floor(Math.random()*220+35)},${Math.floor(Math.random()*220+35)},${Math.floor(Math.random()*220+35)})`
        : `rgb(${Math.floor(Math.random()*100+155)},${Math.floor(Math.random()*100+155)},${Math.floor(Math.random()*100+155)})`;
      bannerParticles.push({
        x: centerX + Math.cos(angle) * distance,
        y: centerY + Math.sin(angle) * distance,
        size: Math.random() * 3 + 2,
        vx: Math.cos(angle) * (Math.random() * 2 + 1),
        vy: Math.sin(angle) * (Math.random() * 2 + 1),
        color: color,
        life: Math.random() * 30 + 20
      });
    }
  }
  
  setInterval(createBannerParticle, 100);
  
  function animateBannerFireworks() {
    ctx2.clearRect(0, 0, canvas.width, canvas.height);
    if (isHoverBanner) {
      ctx2.fillStyle = "rgba(0,0,0,0.1)";
      ctx2.fillRect(0, 0, canvas.width, canvas.height);
    }
    
    for (let i = bannerParticles.length - 1; i >= 0; i--) {
      const p = bannerParticles[i];
      ctx2.fillStyle = p.color;
      ctx2.beginPath();
      ctx2.arc(p.x, p.y, p.size, 0, Math.PI * 2);
      ctx2.fill();
      
      p.x += p.vx;
      p.y += p.vy;
      p.size *= 0.97;
      p.life--;
      
      if (p.life <= 0) bannerParticles.splice(i, 1);
    }
    requestAnimationFrame(animateBannerFireworks);
  }
  animateBannerFireworks();
});
</script>
<!-- 宫崎骏风格互动黑猫（修复点击冲突） -->
<div id="cat-container" style="position: fixed; z-index: 9999; width: 100%; height: 100%; top: 0; left: 0; pointer-events: none;"></div>

<script>
// 延迟加载，避免影响博客主内容加载
setTimeout(() => {
    const container = document.getElementById('cat-container');

    // 创建猫元素（仅猫本身可交互，容器不遮挡）
    const cat = document.createElement('div');
    cat.id = 'ghibli-cat';
    cat.style.cssText = `
        position: absolute;
        width: 120px;
        height: 100px;
        cursor: grab;
        transition: all 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
        pointer-events: auto; /* 仅猫本身可交互 */
    `;
    container.appendChild(cat);

    // 创建脚印容器（不遮挡点击）
    const pawContainer = document.createElement('div');
    pawContainer.id = 'paw-prints';
    pawContainer.style.cssText = `
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none; /* 脚印不影响点击 */
    `;
    container.appendChild(pawContainer);

    // 猫状态管理
    const catState = {
        x: Math.random() * (window.innerWidth - 120),
        y: Math.random() * (window.innerHeight - 100),
        directionX: Math.random() > 0.5 ? 1 : -1,
        directionY: Math.random() > 0.5 ? 1 : -1,
        speed: 1 + Math.random() * 1.2,
        isMoving: true,
        isFlipped: false,
        isSitting: false,
        actionCooldown: 0,
        lastPawPosition: 0,
        pawInterval: 60,
        isDragging: false,
        offsetX: 0,
        offsetY: 0,
        isEdgeHidden: false
    };

    // 猫的外观样式
    cat.innerHTML = `
        <div class="cat-body" style="
            width: 100%;
            height: 100%;
            position: relative;
            transition: transform 0.3s ease;
        ">
            <div style="position: absolute; top: 40px; left: 20px; width: 80px; height: 40px; background: #000; border-radius: 40% 50% 30% 30%;"></div>
            <div style="position: absolute; top: 15px; left: 30px; width: 60px; height: 45px; background: #000; border-radius: 55% 55% 50% 50%;"></div>
            <div style="position: absolute; top: 5px; left: 25px; width: 0; height: 0; border-left: 8px solid transparent; border-right: 8px solid transparent; border-bottom: 25px solid #000; transform: rotate(-15deg);">
                <div style="position: absolute; top: 10px; left: -5px; width: 0; height: 0; border-left: 5px solid transparent; border-right: 5px solid transparent; border-bottom: 15px solid #e0e0e0;"></div>
            </div>
            <div style="position: absolute; top: 5px; left: 87px; width: 0; height: 0; border-left: 8px solid transparent; border-right: 8px solid transparent; border-bottom: 25px solid #000; transform: rotate(15deg);">
                <div style="position: absolute; top: 10px; left: -5px; width: 0; height: 0; border-left: 5px solid transparent; border-right: 5px solid transparent; border-bottom: 15px solid #e0e0e0;"></div>
            </div>
            <div style="position: absolute; top: 35px; left: 80px; width: 25px; height: 10px; background: #b22222; border-radius: 3px; z-index: 1;"></div>
            <div style="position: absolute; top: 30px; left: 85px; width: 15px; height: 15px; background: #b22222; border-radius: 50%; z-index: 1;"></div>
            <div class="cat-tail" style="position: absolute; top: 50px; left: 90px; width: 35px; height: 6px; background: #000; border-radius: 3px; transform: rotate(-20deg);"></div>
            <div style="position: absolute; top: 70px; left: 30px; width: 12px; height: 15px; background: #000; border-radius: 40%;"></div>
            <div style="position: absolute; top: 70px; left: 78px; width: 12px; height: 15px; background: #000; border-radius: 40%;"></div>
            <div style="position: absolute; top: 83px; left: 30px; width: 12px; height: 4px; background: #555; border-radius: 50%;"></div>
            <div style="position: absolute; top: 83px; left: 78px; width: 12px; height: 4px; background: #555; border-radius: 50%;"></div>
            <div class="cat-eyes" style="position: absolute; top: 30px; left: 40px; width: 40px; height: 10px; display: flex; justify-content: space-between;">
                <div style="width: 10px; height: 10px; background: #4CAF50; border-radius: 40% 60% 50% 50%; position: relative; overflow: hidden; box-shadow: inset 0 0 3px rgba(0,0,0,0.2);">
                    <div style="position: absolute; top: 2px; left: 3px; width: 4px; height: 6px; background: #1B5E20; border-radius: 30%;"></div>
                    <div style="position: absolute; top: 1px; left: 1px; width: 3px; height: 3px; background: rgba(255,255,255,0.9); border-radius: 50%;"></div>
                </div>
                <div style="width: 10px; height: 10px; background: #4CAF50; border-radius: 60% 40% 50% 50%; position: relative; overflow: hidden; box-shadow: inset 0 0 3px rgba(0,0,0,0.2);">
                    <div style="position: absolute; top: 2px; left: 3px; width: 4px; height: 6px; background: #1B5E20; border-radius: 30%;"></div>
                    <div style="position: absolute; top: 1px; left: 6px; width: 3px; height: 3px; background: rgba(255,255,255,0.9); border-radius: 50%;"></div>
                </div>
            </div>
            <div style="position: absolute; top: 45px; left: 57px; width: 6px; height: 6px; background: #ffd700; border-radius: 50%;"></div>
            <div style="position: absolute; top: 50px; left: 58px; width: 4px; height: 3px; border: 1px solid #333; border-top: none; border-radius: 0 0 3px 3px;"></div>
        </div>
        <div class="cat-speech" style="
            position: absolute;
            top: -60px;
            left: 50%;
            transform: translateX(-50%);
            background: #fff;
            padding: 10px 18px;
            border-radius: 15px;
            font-size: 14px;
            color: #333;
            white-space: nowrap;
            display: none;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
            border: 1px solid #e0e0e0;
            z-index: 10;
            pointer-events: none; /* 对话气泡不影响点击 */
        "></div>
    `;

    // 互动文本
    const speechTexts = [
    "爸爸。",
    "妈妈。",
    "我想吃猫条呢。",
    "喂喂喂！我需要被打屁屁。",
    "大胆我呀是一只超勇敢的小猫咪呢。", 
    "拖我到边缘，我会趴好哦～",
    "被抓住啦！要带我去哪里？",
    "贴在边上晒太阳真舒服～",
    "你知道吗？我会自己找地方待着～",
    "拖动的时候要小心我的尾巴呀～"
    ];

    // 创建脚印
    function createPawPrint(x, y) {
        const paw = document.createElement('div');
        paw.innerHTML = `
            <div style="position: absolute; width: 8px; height: 8px; background: rgba(245, 245, 220, 0.8); border-radius: 40%;"></div>
            <div style="position: absolute; top: -5px; left: 5px; width: 6px; height: 6px; background: rgba(245, 245, 220, 0.8); border-radius: 40%;"></div>
            <div style="position: absolute; top: -5px; left: -5px; width: 6px; height: 6px; background: rgba(245, 245, 220, 0.8); border-radius: 40%;"></div>
        `;
        paw.style.cssText = `
            position: absolute;
            left: ${x}px;
            top: ${y}px;
            transform: rotate(${Math.random() * 30 - 15}deg);
            opacity: 0.7;
            transition: opacity 3s ease-out;
        `;
        pawContainer.appendChild(paw);

        // 自动消失
        setTimeout(() => {
            paw.style.opacity = '0';
            setTimeout(() => paw.remove(), 3000);
        }, 5000);
    }

    // 拖动功能
    cat.addEventListener('mousedown', (e) => {
        catState.isDragging = true;
        catState.isMoving = false;
        cat.style.cursor = 'grabbing';
        
        // 修正隐藏状态的偏移量
        const visibleX = catState.isEdgeHidden ? 
            (catState.isFlipped ? catState.x + 60 : catState.x) : 
            catState.x;
        catState.offsetX = e.clientX - visibleX;
        catState.offsetY = e.clientY - catState.y;
        
        // 拖动时解除隐藏
        if (catState.isEdgeHidden) {
            catState.x = catState.isFlipped ? catState.x + 60 : catState.x;
            catState.isEdgeHidden = false;
            cat.style.left = `${catState.x}px`;
        }
        e.preventDefault(); // 仅阻止猫本身的默认行为，不影响页面其他元素
    });

    document.addEventListener('mousemove', (e) => {
        if (!catState.isDragging) return;
        // 拖动时完全显示
        catState.x = e.clientX - catState.offsetX;
        catState.y = e.clientY - catState.offsetY;
        catState.x = Math.max(-60, Math.min(catState.x, window.innerWidth - 60));
        catState.y = Math.max(0, Math.min(catState.y, window.innerHeight - 100));
        cat.style.left = `${catState.x}px`;
        cat.style.top = `${catState.y}px`;
    });

    document.addEventListener('mouseup', () => {
        if (!catState.isDragging) return;
        catState.isDragging = false;
        cat.style.cursor = 'grab';
        checkEdgeSnap(); // 检查是否需要隐藏
        setTimeout(() => {
            if (!catState.isSitting) catState.isMoving = true;
        }, 3000);
    });

    // 边缘半隐藏逻辑
    function checkEdgeSnap() {
        const edgeTolerance = 30;
        const windowWidth = window.innerWidth;
        const windowHeight = window.innerHeight;
        const halfWidth = 60;

        // 左边缘隐藏
        if (catState.x <= edgeTolerance && !catState.isEdgeHidden) {
            catState.x = -halfWidth;
            catState.isFlipped = false;
            cat.querySelector('.cat-body').style.transform = 'scaleX(1)';
            cat.querySelector('.cat-tail').style.left = '90px';
            cat.querySelector('.cat-tail').style.transform = 'rotate(-20deg)';
            catState.isEdgeHidden = true;
        }
        // 右边缘隐藏
        else if (catState.x >= windowWidth - halfWidth - edgeTolerance && !catState.isEdgeHidden) {
            catState.x = windowWidth - halfWidth;
            catState.isFlipped = true;
            cat.querySelector('.cat-body').style.transform = 'scaleX(-1)';
            cat.querySelector('.cat-tail').style.left = '5px';
            cat.querySelector('.cat-tail').style.transform = 'rotate(20deg)';
            catState.isEdgeHidden = true;
        }
        // 取消隐藏
        else if (catState.x > edgeTolerance && catState.x < windowWidth - halfWidth - edgeTolerance) {
            catState.isEdgeHidden = false;
        }

        // 上下边缘定位
        if (catState.y <= edgeTolerance) catState.y = 0;
        else if (catState.y >= windowHeight - 100 - edgeTolerance) catState.y = windowHeight - 100;

        cat.style.left = `${catState.x}px`;
        cat.style.top = `${catState.y}px`;
    }

    // 动画更新
    function updateCat() {
        if (catState.isMoving && !catState.isSitting && catState.actionCooldown <= 0 && !catState.isDragging) {
            const bounce = Math.sin(Date.now() * 0.005) * 2;
            cat.style.transform = `translateY(${bounce}px)`;

            const prevX = catState.x;
            const prevY = catState.y;

            catState.x += catState.directionX * catState.speed;
            catState.y += catState.directionY * catState.speed;

            // 边界反弹（自动移动不隐藏）
            const safeXMin = 0;
            const safeXMax = window.innerWidth - 120;
            if (catState.x <= safeXMin || catState.x >= safeXMax) {
                catState.directionX *= -1;
                catState.isFlipped = !catState.isFlipped;
                cat.querySelector('.cat-body').style.transform = catState.isFlipped ? 'scaleX(-1)' : 'scaleX(1)';
                cat.querySelector('.cat-tail').style.left = catState.isFlipped ? '5px' : '90px';
                cat.querySelector('.cat-tail').style.transform = catState.isFlipped ? 'rotate(20deg)' : 'rotate(-20deg)';
            }
            if (catState.y <= 0 || catState.y >= windowHeight - 100) {
                catState.directionY *= -1;
            }

            // 限制移动范围
            catState.x = Math.max(safeXMin, Math.min(catState.x, safeXMax));
            catState.y = Math.max(0, Math.min(catState.y, windowHeight - 100));

            // 生成脚印
            const distanceMoved = Math.hypot(catState.x - prevX, catState.y - prevY);
            catState.lastPawPosition += distanceMoved;
            if (catState.lastPawPosition >= catState.pawInterval) {
                const pawX = catState.isFlipped ? catState.x + 30 : catState.x + 80;
                const pawY = catState.y + 85;
                createPawPrint(pawX, pawY);
                catState.lastPawPosition = 0;
            }

            cat.style.left = `${catState.x}px`;
            cat.style.top = `${catState.y}px`;

            // 随机坐下
            if (Math.random() < 0.0015) {
                catState.isSitting = true;
                catState.actionCooldown = 300;
                cat.querySelector('.cat-body').style.transform = catState.isFlipped ? 'scaleX(-1) translateY(5px)' : 'translateY(5px)';
            }
        } else if (catState.actionCooldown > 0) {
            catState.actionCooldown--;
            if (catState.actionCooldown === 0 && catState.isSitting) {
                catState.isSitting = false;
                cat.querySelector('.cat-body').style.transform = catState.isFlipped ? 'scaleX(-1)' : 'scaleX(1)';
            }
        } else {
            cat.style.transform = 'translateY(0)';
        }

        requestAnimationFrame(updateCat);
    }

    // 点击互动
    cat.addEventListener('click', (e) => {
        e.stopPropagation(); // 防止点击猫时触发页面其他点击事件
        if (catState.isSitting) {
            catState.isSitting = false;
            catState.isMoving = true;
            catState.actionCooldown = 0;
            cat.querySelector('.cat-body').style.transform = catState.isFlipped ? 'scaleX(-1)' : 'scaleX(1)';
        } else {
            catState.isMoving = !catState.isMoving;
            catState.actionCooldown = 200;
        }

        const speech = cat.querySelector('.cat-speech');
        speech.textContent = speechTexts[Math.floor(Math.random() * speechTexts.length)];
        speech.style.display = 'block';
        setTimeout(() => { 
            speech.style.opacity = '0';
            setTimeout(() => {
                speech.style.display = 'none';
                speech.style.opacity = '1';
            }, 500);
        }, 4000);

        // 眨眼效果
        const pupils = cat.querySelectorAll('.cat-eyes div div:first-child');
        pupils.forEach(p => p.style.width = '6px');
        setTimeout(() => pupils.forEach(p => p.style.width = '4px'), 800);
    });

    // 窗口 resize 适配
    window.addEventListener('resize', () => {
        const windowWidth = window.innerWidth;
        const windowHeight = window.innerHeight;
        if (catState.isEdgeHidden) {
            catState.x = catState.isFlipped ? windowWidth - 60 : -60;
        } else {
            catState.x = Math.max(0, Math.min(catState.x, windowWidth - 120));
        }
        catState.y = Math.max(0, Math.min(catState.y, windowHeight - 100));
        cat.style.left = `${catState.x}px`;
        cat.style.top = `${catState.y}px`;
    });

    // 初始化位置
    cat.style.left = `${catState.x}px`;
    cat.style.top = `${catState.y}px`;
    updateCat();
}, 1000); // 延迟1秒加载，优先加载博客内容
</script>

<!-- 6. 全局样式（优化层级和适配） -->
<style>
/* 导航栏彩虹效果 */
.navbar-brand strong {
  color: #fff !important;
  font-weight: bold !important;
  transition: all 0.3s ease !important;
}
.navbar-brand:hover strong {
  background: linear-gradient(90deg, 
    #ff0000, #ff9900, #ffff00, 
    #33cc33, #3366ff, #9933ff, #ff33cc
  ) !important;
  background-size: 300% 100% !important;
  -webkit-background-clip: text !important;
  background-clip: text !important;
  color: transparent !important;
  animation: rainbow 2s linear infinite !important;
}

.nav-link span {
  color: #fff !important;
  transition: all 0.3s ease !important;
}
.nav-link:hover span {
  background: linear-gradient(90deg, 
    #ff0000, #ff9900, #ffff00, 
    #33cc33, #3366ff, #9933ff, #ff33cc
  ) !important;
  background-size: 300% 100% !important;
  -webkit-background-clip: text !important;
  background-clip: text !important;
  color: transparent !important;
  animation: rainbow 2s linear infinite !important;
}

@keyframes rainbow {
  0% { background-position: 0% 50%; }
  100% { background-position: 300% 50%; }
}

/* 基础样式优化 */
.navbar-brand, .nav-link {
  background: none !important;
  color: #fff !important;
}
.navbar-brand:focus strong,
.nav-link:focus span {
  color: #fff !important;
  outline: none !important;
}

.index-header a {
  display: inline-block !important;
  transition: opacity 0.3s ease !important;
}

.banner .mask {
  background-color: rgba(0,0,0,0.4) !important;
}
.banner-text span {
  color: #fff !important;
  font-weight: bold !important;
  text-shadow: 0 2px 8px rgba(0,0,0,0.8) !important; /* 文字加阴影，更清晰 */
}

/* 确保内容层级高于背景特效 */
.post-content, .container {
  position: relative;
  z-index: 10;
}

/* 适配移动端 */
@media (max-width: 768px) {
  #banner { height: 300px !important; }
  .banner-text span:first-child { font-size: 1.8rem !important; }
  .banner-text span:last-child { font-size: 1rem !important; }
  #ghibli-cat { width: 100px !important; height: 80px !important; } /* 移动端缩小黑猫 */
}
</style>
</body>

</html>